# $Id: readme,v 1.4 2007/01/14 19:32:22 lizhijie Exp $
# 
                    README for Flash根文件系统
                                 李志杰 2006.12.03

创建更文件系统的步骤：
1. 创建相关的目录结构和设备文件

2. 拷贝预发布的文件

3. 释放需要安装的软件包

4. 以分区大小创建映像文件
                                        


烧入Flash文件系统的命令
	protect off 1:6-127
	loadb 100000然后传程序
	erase 501b0000 503fffff
	cp 100000 501b0000 94000


烧录Kernel的步骤如下：
	protect off 1:6-90
	loadb 100000
	erase 50030000 501affff
	cp 100000 50030000 60000



解决启动时检测JFFS2的警告信息   2007.01.14
     JFFS2文件系统在每个Flash块的
          开始为 19 85 E0 02 00 00
          结束为          FF FF FF

     直接查看生成的文件系统镜像可以发现问题
     
     旧版的mkfs.jffs2在pad文件系统时全部使用FF，而不管擦除块的大小
     
     更新PC机下的mkfs.jffs2程序，它可以自动生成cleanmarker，即需要清楚
         块的标志，这样就可以不再提示警告信息
         
     新的Clean Mark为12字节
         19 85 20 03 00 00 00 0C F0 60 DC 98
         Clean Mark的大小可以在执行mkfs.jffs2时指定
     
    指定擦除块大小为32K时，kernel会提示警告，因此不再指定擦除块大小，而
        使用默认的64K
        估计原因是kernel中的块大小指定不准确
        
注意：
    JFFS2装载后显示的使用空间大小和实际镜像文件占用的块数是不同的
        例如在2007.01.14的文件系统启动后显示可以使用的空闲空间为
        160K，但是生成镜像文件仅占用了60块，还要14块是没有使用的，
        JFFS2总共可以使用的块数为74快。
        
        也即镜像中的文件占用了1920K，实际空间是2368K。
        
        这样镜像文件的空闲空间和加载后文件系统的空闲空间是不同的，
        这是因为JFFS2是日志型文件系统，所以日志需要占用空间的。
        
        
    可以在生成镜像文件时，不使用pad参数查看实际的块数，也可以通过
        直接查看镜像文件中的内容而确定使用的块数


